
function [y] = chapter3problems(mu, r0, v0, t0, t)

[r,v] = rvATt(t, mu, t0, t, r0, v0);
[rPCIf,vPCIf,E0,nu0,E,nu] = propagateKepler(t0,t,r0,v0,mu);
[tout, y] = integrate(mu, t0, t, r0, v0);
figure
hold on
plot3(rPCIf(:,1), rPCIf(:,2), rPCIf(:,3), 'r')
plot3(y(:,1), y(:,2), y(:,3), 'b')
legend('kepler','ode113')

fprintf('-------------------------------------------------------------\n');
fprintf('-------------------------------------------------------------\n'); 
fprintf('-------------------------------------------------------------\n');
fprintf('-------------------------------------------------------------\n'); 
fprintf('                          Input:                         \n'); 
fprintf('-------------------------------------------------------------\n'); 
fprintf('The gravitational parameter: %16.8f\n', mu); 
fprintf('-------------------------------------------------------------\n'); 
fprintf('Initial time: %16.8f\n', t0); 
fprintf('-------------------------------------------------------------\n');
fprintf('Final time: %16.8f\n', t); 
fprintf('-------------------------------------------------------------\n');
fprintf('Initial ECI position:\n [%16.8f,%16.8f,%16.8f]\n', r0); 
fprintf('-------------------------------------------------------------\n');
fprintf('Initial ECI velocity:\n [%16.8f,%16.8f,%16.8f]\n', v0); 
fprintf('-------------------------------------------------------------\n');
fprintf('                          Output:                         \n'); 
fprintf('-------------------------------------------------------------\n');  
fprintf('The Eccentric anomaly: %16.8f\n', E); 
fprintf('-------------------------------------------------------------\n');
fprintf('The true anomaly: %16.8f\n', nu); 
fprintf('-------------------------------------------------------------\n');
fprintf('The ECI position using Kepler:\n [%16.8f,%16.8f,%16.8f]\n', r); 
fprintf('-------------------------------------------------------------\n');
fprintf('The ECI velocity using Kepler:\n [%16.8f,%16.8f,%16.8f]\n', v); 
fprintf('-------------------------------------------------------------\n');
fprintf('The ECI position using ode113:\n [%16.8f,%16.8f,%16.8f]\n', y(end,1), y(end,2), y(end,3));
fprintf('-------------------------------------------------------------\n');
fprintf('The ECI velocity using ode113:\n [%16.8f,%16.8f,%16.8f]\n', y(end,4), y(end,5), y(end,6));
fprintf('-------------------------------------------------------------\n');
fprintf('rPCIf array (Kepler) :\n');
fprintf('[%16.8f,%16.8f,%16.8f]\n', rPCIf);
fprintf('vPCIf array (Kepler):\n');
fprintf('[%16.8f,%16.8f,%16.8f]\n', vPCIf);
fprintf('-------------------------------------------------------------\n');
fprintf('-------------------------------------------------------------\n');
fprintf('-------------------------------------------------------------\n');
fprintf('-------------------------------------------------------------\n');




